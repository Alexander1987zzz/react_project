{"ast":null,"code":"var _jsxFileName = \"D:\\\\11\\\\react_project\\\\src\\\\components\\\\UserForm.js\";\nimport React, { Component } from 'react';\nimport Container from \"@material-ui/core/Container\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Card from \"@material-ui/core/Card\";\nimport Button from \"@material-ui/core/Button\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass UserForm extends Component {\n  constructor(props) {\n    super(props);\n    this.validationState = {\n      firstName: {\n        errors: []\n      },\n      lastName: {\n        errors: []\n      },\n      email: {\n        errors: []\n      },\n      birthDate: {\n        errors: []\n      },\n      allField: {\n        errors: []\n      }\n    };\n    this.emptyItem = {\n      firstName: '',\n      lastName: '',\n      email: '',\n      birthDate: ''\n    };\n    this.state = {\n      item: this.emptyItem,\n      validation: this.validationState,\n      isValidForm: false\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  errorRender(validationFieldState) {\n    if (validationFieldState.errors.length) {\n      return validationFieldState.errors.map(error => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-field\",\n        children: [\"- \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 64\n      }, this));\n    }\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n  }\n\n  async componentDidMount() {\n    if (this.props.match.params.id !== 'new') {\n      const user = await (await fetch(`/api/users?id=${this.props.match.params.id}`)).json();\n      this.initValidation(user);\n    }\n  }\n\n  initValidation(user) {\n    const validation = { ...this.state.validation\n    };\n\n    for (let key in user) {\n      if (key !== 'id') {\n        validation[key] = this.validation(key, user[key].toString());\n      }\n    }\n\n    const isValidForm = this.getValidationStatus(validation);\n    this.setState({\n      item: user,\n      isValidForm,\n      validation\n    });\n  }\n\n  validation(fieldName, fieldValue) {\n    const self = this;\n    const fieldValidation = { ...self.state.validation[fieldName],\n      errors: []\n    };\n    fieldValidation.validators.forEach(validator => {\n      const errors = fieldValidation.errors;\n      fieldValidation.errors = [...errors, ...validator(fieldValue)];\n    });\n    return fieldValidation;\n  }\n\n  handleChange(event) {\n    const target = event.target;\n    const value = target.value;\n    const name = target.name;\n    let item = { ...this.state.item\n    };\n    item[name] = value;\n    const validation = { ...this.state.validation,\n      [name]: this.validation(name, value.toString())\n    };\n    validation.allField.errors = [];\n    const isValidForm = this.getValidationStatus(validation);\n    this.setState({ ...this.state,\n      validation,\n      item,\n      isValidForm\n    });\n  }\n\n  getValidationStatus(validation) {\n    return Object.values(validation).every(validField => !validField.errors.length);\n  }\n\n  async handleSubmit(event) {\n    const self = this;\n    event.preventDefault();\n    const {\n      item\n    } = this.state;\n    const userData = {\n      firstName: item.firstName,\n      lastName: item.lastName,\n      email: item.email,\n      birthDate: item.birthDate\n    };\n    const endpoint = +item.id ? `/api/users?id=${item.id}` : '/api/users';\n    await fetch(endpoint, {\n      method: item.id ? 'PUT' : 'POST',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(userData)\n    }).then(response => {\n      if (![400, 500].includes(+response.status)) {\n        window.location.href = 'http://34.88.120.86:3000/users';\n        return null;\n      }\n\n      return response.text();\n    }).then(message => {\n      const validation = { ...self.state.validation,\n        allField: {\n          errors: [message]\n        }\n      };\n      self.setState({ ...self.state,\n        validation\n      });\n    });\n  }\n\n  render() {\n    const {\n      item,\n      validation,\n      isValidForm\n    } = this.state;\n\n    const title = /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: item.id ? 'Edit User' : 'Add User'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 23\n    }, this);\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        children: [title, /*#__PURE__*/_jsxDEV(Form, {\n          onSubmit: this.handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(FormGroup, {\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              for: \"firstname\",\n              children: \"First Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              type: \"text\",\n              name: \"firstName\",\n              id: \"firstName\",\n              value: item.firstName || '',\n              onChange: this.handleChange,\n              autoComplete: \"firstName\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 25\n            }, this), this.errorRender(validation.firstName)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              for: \"lastName\",\n              children: \"Last Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              type: \"text\",\n              name: \"lastName\",\n              id: \"lastName\",\n              value: item.lastName || '',\n              onChange: this.handleChange,\n              autoComplete: \"lastName\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 25\n            }, this), this.errorRender(validation.lastName)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              for: \"email\",\n              children: \"Email\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              type: \"text\",\n              name: \"email\",\n              id: \"email\",\n              value: item.email || '',\n              onChange: this.handleChange,\n              autoComplete: \"email\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 25\n            }, this), this.errorRender(validation.email)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              for: \"birthDate\",\n              children: \"Birth Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(Input, {\n              type: \"text\",\n              name: \"birthDate\",\n              id: \"birthDate\",\n              value: item.birthDate || '',\n              onChange: this.handleChange,\n              autoComplete: \"birthDate\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 25\n            }, this), this.errorRender(validation.birthDate)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n            children: [this.errorRender(validation.allField), /*#__PURE__*/_jsxDEV(Button, {\n              color: \"primary\",\n              type: \"submit\",\n              disabled: !isValidForm,\n              children: \"Save\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 25\n            }, this), ' ', /*#__PURE__*/_jsxDEV(Button, {\n              color: \"secondary\",\n              tag: Link,\n              to: \"/users\",\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 16\n    }, this);\n  }\n\n}\n\nexport default UserForm;","map":{"version":3,"sources":["D:/11/react_project/src/components/UserForm.js"],"names":["React","Component","Container","TextField","Card","Button","UserForm","constructor","props","validationState","firstName","errors","lastName","email","birthDate","allField","emptyItem","state","item","validation","isValidForm","handleChange","bind","handleSubmit","errorRender","validationFieldState","length","map","error","componentDidMount","match","params","id","user","fetch","json","initValidation","key","toString","getValidationStatus","setState","fieldName","fieldValue","self","fieldValidation","validators","forEach","validator","event","target","value","name","Object","values","every","validField","preventDefault","userData","endpoint","method","headers","body","JSON","stringify","then","response","includes","status","window","location","href","text","message","render","title","Link"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport Container from \"@material-ui/core/Container\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\n\r\n\r\nclass UserForm extends Component {\r\n    validationState = {\r\n        firstName: {\r\n            errors: [],\r\n\r\n        },\r\n        lastName: {\r\n            errors: [],\r\n        },\r\n        email: {\r\n            errors: [],\r\n        },\r\n        birthDate: {\r\n            errors: [],\r\n        },\r\n        allField: {\r\n            errors: []\r\n        }\r\n    }\r\n\r\n    emptyItem = {\r\n        firstName: '',\r\n        lastName: '',\r\n        email: '',\r\n        birthDate: ''\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            item: this.emptyItem,\r\n            validation: this.validationState,\r\n            isValidForm: false\r\n        };\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n    }\r\n\r\n    errorRender(validationFieldState) {\r\n        if (validationFieldState.errors.length) {\r\n            return validationFieldState.errors.map((error) => (<div className=\"error-field\">- {error}</div>));\r\n        }\r\n        return <></>;\r\n    }\r\n\r\n    async componentDidMount() {\r\n        if (this.props.match.params.id !== 'new') {\r\n            const user = await (await fetch(`/api/users?id=${this.props.match.params.id}`)).json();\r\n            this.initValidation(user);\r\n        }\r\n    }\r\n\r\n    initValidation(user) {\r\n        const validation = {...this.state.validation};\r\n        for (let key in user) {\r\n            if (key !== 'id') {\r\n                validation[key] = this.validation(key, user[key].toString());\r\n            }\r\n        }\r\n\r\n        const isValidForm = this.getValidationStatus(validation);\r\n        this.setState({item: user, isValidForm, validation});\r\n    }\r\n\r\n    validation(fieldName, fieldValue){\r\n        const self = this;\r\n        const fieldValidation = {...self.state.validation[fieldName], errors: []};\r\n        fieldValidation.validators.forEach(validator => {\r\n            const errors = fieldValidation.errors;\r\n            fieldValidation.errors = [...errors, ...validator(fieldValue)];\r\n        });\r\n\r\n        return fieldValidation;\r\n    }\r\n    handleChange(event) {\r\n        const target = event.target;\r\n        const value = target.value;\r\n        const name = target.name;\r\n        let item = {...this.state.item};\r\n        item[name] = value;\r\n        const validation = {\r\n            ...this.state.validation,\r\n            [name]: this.validation(name, value.toString())\r\n        };\r\n        validation.allField.errors = [];\r\n        const isValidForm = this.getValidationStatus(validation);\r\n        this.setState({...this.state, validation, item, isValidForm});\r\n    }\r\n\r\n    getValidationStatus(validation) {\r\n        return Object.values(validation)\r\n            .every(validField => !validField.errors.length);\r\n    }\r\n\r\n    async handleSubmit(event) {\r\n        const self = this;\r\n        event.preventDefault();\r\n        const {item} = this.state;\r\n        const userData = {\r\n            firstName: item.firstName,\r\n            lastName: item.lastName,\r\n            email: item.email,\r\n            birthDate: item.birthDate\r\n        }\r\n\r\n        const endpoint = +item.id ? `/api/users?id=${item.id}` : '/api/users';\r\n\r\n        await fetch(endpoint, {\r\n            method: (item.id) ? 'PUT' : 'POST',\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(userData),\r\n        }).then(response => {\r\n            if (![400, 500].includes(+response.status)) {\r\n                window.location.href = 'http://34.88.120.86:3000/users';\r\n                return null;\r\n            }\r\n            return response.text();\r\n        }).then(message => {\r\n            const validation = {...self.state.validation, allField: {errors: [message]}};\r\n            self.setState({...self.state, validation});\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const {item, validation, isValidForm} = this.state;\r\n        const title = <h2>{item.id ? 'Edit User' : 'Add User'}</h2>;\r\n\r\n        return <div>\r\n            <Container>\r\n                {title}\r\n                <Form onSubmit={this.handleSubmit}>\r\n                    <FormGroup>\r\n                        <Label for=\"firstname\">First Name</Label>\r\n                        <Input type=\"text\" name=\"firstName\" id=\"firstName\" value={item.firstName || ''}\r\n                               onChange={this.handleChange} autoComplete=\"firstName\"/>\r\n                        {this.errorRender(validation.firstName)}\r\n                    </FormGroup>\r\n                    <FormGroup>\r\n                        <Label for=\"lastName\">Last Name</Label>\r\n                        <Input type=\"text\" name=\"lastName\" id=\"lastName\" value={item.lastName || ''}\r\n                               onChange={this.handleChange} autoComplete=\"lastName\"/>\r\n                        {this.errorRender(validation.lastName)}\r\n                    </FormGroup>\r\n                    <FormGroup>\r\n                        <Label for=\"email\">Email</Label>\r\n                        <Input type=\"text\" name=\"email\" id=\"email\" value={item.email || ''}\r\n                               onChange={this.handleChange} autoComplete=\"email\"/>\r\n                        {this.errorRender(validation.email)}\r\n                    </FormGroup>\r\n                    <FormGroup>\r\n                        <Label for=\"birthDate\">Birth Date</Label>\r\n                        <Input type=\"text\" name=\"birthDate\" id=\"birthDate\" value={item.birthDate || ''}\r\n                               onChange={this.handleChange} autoComplete=\"birthDate\"/>\r\n                        {this.errorRender(validation.birthDate)}\r\n                    </FormGroup>\r\n                    <FormGroup>\r\n                        {this.errorRender(validation.allField)}\r\n                        <Button color=\"primary\" type=\"submit\" disabled={!isValidForm}>Save</Button>{' '}\r\n                        <Button color=\"secondary\" tag={Link} to=\"/users\">Cancel</Button>\r\n                    </FormGroup>\r\n                </Form>\r\n            </Container>\r\n        </div>\r\n    }\r\n}\r\n\r\nexport default UserForm;"]},"metadata":{},"sourceType":"module"}