{"version":3,"file":"Material.js","sourceRoot":"","sources":["../src/Material.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  createMuiTheme,\n  createStyles,\n  FormControl as _FormControl,\n  TextField as _TextField,\n  Theme,\n  WithStyles,\n  withStyles\n} from '@material-ui/core';\nimport { FormControlProps } from '@material-ui/core/FormControl';\nimport { TextFieldProps } from '@material-ui/core/TextField';\nimport { ThemeProvider } from '@material-ui/styles';\nimport * as PropTypes from 'prop-types';\nimport {\n  assert,\n  Async,\n  deepForEach,\n  Field,\n  FieldFeedback as _FieldFeedback,\n  FieldFeedbackBaseProps,\n  FieldFeedbacks,\n  FormWithConstraints as _FormWithConstraints,\n  FormWithConstraintsChildContext\n} from 'react-form-with-constraints';\n\ninterface FormControlState {\n  field: Field | undefined;\n}\n\ntype FormControlContext = FormWithConstraintsChildContext;\n\nexport class FormControl extends React.Component<FormControlProps, FormControlState> {\n  static contextTypes: React.ValidationMap<FormControlContext> = {\n    form: PropTypes.instanceOf(_FormWithConstraints).isRequired\n  };\n  context!: FormControlContext;\n\n  state: FormControlState = {\n    field: undefined\n  };\n\n  /* eslint-disable react/destructuring-assignment */\n\n  componentDidMount() {\n    this.context.form.addFieldWillValidateEventListener(this.fieldWillValidate);\n    this.context.form.addFieldDidValidateEventListener(this.fieldDidValidate);\n    this.context.form.addFieldDidResetEventListener(this.fieldDidReset);\n  }\n\n  componentWillUnmount() {\n    this.context.form.removeFieldWillValidateEventListener(this.fieldWillValidate);\n    this.context.form.removeFieldDidValidateEventListener(this.fieldDidValidate);\n    this.context.form.removeFieldDidResetEventListener(this.fieldDidReset);\n  }\n\n  getAssociatedFieldName() {\n    const fieldNames = new Set<string>();\n\n    deepForEach(this.props.children, child => {\n      if (child.props !== undefined) {\n        const fieldName = child.props.name;\n        if (fieldName !== undefined && fieldName.length > 0) {\n          fieldNames.add(fieldName);\n        }\n      }\n    });\n\n    assert(\n      fieldNames.size === 1,\n      // [...Set] vs Array.from(Set): the latter doesn't need downlevelIteration with IE\n      // eslint-disable-next-line unicorn/prefer-spread\n      `0 or multiple [name=\"*\"] instead of 1: '${Array.from(fieldNames)}'`\n    );\n\n    // Return the first and only entry\n    return fieldNames.values().next().value;\n  }\n\n  /* eslint-enable react/destructuring-assignment */\n\n  fieldWillValidate = (fieldName: string) => {\n    // Ignore the event if it's not for us\n    if (fieldName === this.getAssociatedFieldName()) {\n      this.setState({ field: undefined });\n    }\n  };\n\n  fieldDidValidate = (field: Field) => {\n    // Ignore the event if it's not for us\n    if (field.name === this.getAssociatedFieldName()) {\n      this.setState({ field });\n    }\n  };\n\n  fieldDidReset = (field: Field) => {\n    // Ignore the event if it's not for us\n    if (field.name === this.getAssociatedFieldName()) {\n      this.setState({ field: undefined });\n    }\n  };\n\n  render() {\n    const { field } = this.state;\n    const error = field !== undefined && field.hasErrors();\n    return <_FormControl error={error} {...this.props} />;\n  }\n}\n\ninterface TextFieldState {\n  field: Field | undefined;\n}\n\nexport class TextField extends React.Component<TextFieldProps, TextFieldState> {\n  static contextTypes: React.ValidationMap<FormControlContext> = {\n    form: PropTypes.instanceOf(_FormWithConstraints).isRequired\n  };\n  context!: FormControlContext;\n\n  state: TextFieldState = {\n    field: undefined\n  };\n\n  /* eslint-disable react/destructuring-assignment */\n\n  componentDidMount() {\n    this.context.form.addFieldWillValidateEventListener(this.fieldWillValidate);\n    this.context.form.addFieldDidValidateEventListener(this.fieldDidValidate);\n    this.context.form.addFieldDidResetEventListener(this.fieldDidReset);\n  }\n\n  componentWillUnmount() {\n    this.context.form.removeFieldWillValidateEventListener(this.fieldWillValidate);\n    this.context.form.removeFieldDidValidateEventListener(this.fieldDidValidate);\n    this.context.form.removeFieldDidResetEventListener(this.fieldDidReset);\n  }\n\n  fieldWillValidate = (fieldName: string) => {\n    // Ignore the event if it's not for us\n    if (fieldName === this.props.name) {\n      this.setState({ field: undefined });\n    }\n  };\n\n  fieldDidValidate = (field: Field) => {\n    // Ignore the event if it's not for us\n    if (field.name === this.props.name) {\n      this.setState({ field });\n    }\n  };\n\n  fieldDidReset = (field: Field) => {\n    // Ignore the event if it's not for us\n    if (field.name === this.props.name) {\n      this.setState({ field: undefined });\n    }\n  };\n\n  /* eslint-enable react/destructuring-assignment */\n\n  render() {\n    const { field } = this.state;\n    const error = field !== undefined && field.hasErrors();\n    return <_TextField error={error} {...this.props} />;\n  }\n}\n\nconst defaultTheme = createMuiTheme({});\n\n// https://v3-5-0.material-ui.com/customization/themes/#nesting-the-theme\nfunction formWithConstraintsTheme(outerTheme: Theme | null) {\n  return {\n    ...(outerTheme || defaultTheme),\n    overrides: {\n      MuiFormHelperText: {\n        root: {\n          // Make FormHelperText invisible when there is no content\n          // https://github.com/mui-org/material-ui/blob/v3.5.1/packages/material-ui/src/FormHelperText/FormHelperText.js#L14-L16\n          '&:empty': {\n            marginTop: 0,\n            minHeight: 0\n          }\n        }\n      }\n    }\n  };\n}\n\nexport class FormWithConstraints extends _FormWithConstraints {\n  render() {\n    return <ThemeProvider theme={formWithConstraintsTheme}>{super.render()}</ThemeProvider>;\n  }\n}\n\nfunction fieldFeedbackStyles(theme: Theme) {\n  return createStyles({\n    root: {\n      // Simulates FormHelperText margin\n      // https://github.com/mui-org/material-ui/blob/v1.0.0-beta.44/packages/material-ui/src/Form/FormHelperText.js#L12\n      '&:not(:last-child)': {\n        marginBottom: theme.spacing()\n      }\n    }\n  });\n}\n\ntype FieldFeedbackPropsWithStyles = FieldFeedbackBaseProps &\n  React.HTMLAttributes<HTMLSpanElement> &\n  WithStyles<typeof fieldFeedbackStyles>;\n\nexport const FieldFeedback = withStyles(fieldFeedbackStyles)(\n  // Without a class name (class extends React.Component) React Developer Tools displays:\n  // <WithStyles(Component) ...>\n  //   <Component>\n  //     <FieldFeedbackWS className=\"Component-root-125\" ...></FieldFeedback>\n  //   </Component>\n  // </WithStyles(Component)>\n  //\n  // With a class name React Developer Tools displays:\n  // <WithStyles(FieldFeedbackWS) ...>\n  //   <FieldFeedbackWS>\n  //     <FieldFeedbackWS className=\"FieldFeedbackWS-root-125\" ...></FieldFeedback>\n  //   </FieldFeedbackWS>\n  // </WithStyles(FieldFeedbackWS)>\n  class FieldFeedbackWS extends React.PureComponent<FieldFeedbackPropsWithStyles> {\n    render() {\n      const { classes, className, ...otherProps } = this.props;\n\n      const classNames = className !== undefined ? `${className} ${classes.root}` : classes.root;\n\n      return <_FieldFeedback className={classNames} {...otherProps} />;\n    }\n  }\n);\n\nexport { FieldFeedbacks, Async };\n"]}